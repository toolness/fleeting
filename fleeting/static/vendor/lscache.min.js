/**
 * lscache library
 * Copyright (c) 2011, Pamela Fox
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//*jshint undef:true, browser:true *//**
 * Creates a namespace for the lscache functions.
 */var lscache=function(){function a(){var e="__lscachetest__",t=e;if(s!==undefined)return s;try{p(e,t),d(e),s=!0}catch(n){s=!1}return s}function f(){return o===undefined&&(o=window.JSON!=null),o}function l(e){return e+t}function c(){return Math.floor((new Date).getTime()/r)}function h(t){return localStorage.getItem(e+u+t)}function p(t,n){localStorage.removeItem(e+u+t),localStorage.setItem(e+u+t,n)}function d(t){localStorage.removeItem(e+u+t)}var e="lscache-",t="-cacheexpiration",n=10,r=6e4,i=Math.floor(864e13/r),s,o,u="";return{set:function(r,s,o){if(!a())return;if(typeof s!="string"){if(!f())return;try{s=JSON.stringify(s)}catch(v){return}}try{p(r,s)}catch(v){if(v.name!=="QUOTA_EXCEEDED_ERR"&&v.name!=="NS_ERROR_DOM_QUOTA_REACHED")return;var m=[],g;for(var y=0;y<localStorage.length;y++){g=localStorage.key(y);if(g.indexOf(e+u)===0&&g.indexOf(t)<0){var b=g.substr((e+u).length),w=l(b),E=h(w);E?E=parseInt(E,n):E=i,m.push({key:b,size:(h(b)||"").length,expiration:E})}}m.sort(function(e,t){return t.expiration-e.expiration});var S=(s||"").length;while(m.length&&S>0)g=m.pop(),d(g.key),d(l(g.key)),S-=g.size;try{p(r,s)}catch(v){return}}o?p(l(r),(c()+o).toString(n)):d(l(r))},get:function(e){if(!a())return null;var t=l(e),r=h(t);if(r){var i=parseInt(r,n);if(c()>=i)return d(e),d(t),null}var s=h(e);if(!s||!f())return s;try{return JSON.parse(s)}catch(o){return s}},remove:function(e){if(!a())return null;d(e),d(l(e))},supported:function(){return a()},flush:function(){if(!a())return;for(var t=localStorage.length-1;t>=0;--t){var n=localStorage.key(t);n.indexOf(e+u)===0&&localStorage.removeItem(n)}},setBucket:function(e){u=e},resetBucket:function(){u=""}}}();